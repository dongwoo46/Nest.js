<!doctype html>
<html>
  <head>
    <title>NestJS WebSocket Chat</title>
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
    <style>
      #messages {
        list-style-type: none;
        padding: 0;
      }
      #form {
        display: flex;
        margin-top: 10px;
      }
      #input {
        flex: 1;
        padding: 10px;
      }
      #username {
        width: 100px;
        padding: 10px;
      }
      #button {
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <ul id="messages"></ul>
    <form id="form" action="">
      <input id="username" autocomplete="off" placeholder="Username" />
      <input id="input" autocomplete="off" placeholder="Message" />
      <button id="button">Send</button>
    </form>

    <script>
      const socket = io('http://localhost:3000');

      document.getElementById('form').addEventListener('submit', function (e) {
        e.preventDefault();
        const username = document.getElementById('username').value;
        const message = document.getElementById('input').value;
        socket.emit('message', { username, message });
        document.getElementById('input').value = '';
      });

      socket.on('message', function (msg) {
        const item = document.createElement('li');
        item.textContent = `${msg.username}: ${msg.message}`;
        document.getElementById('messages').appendChild(item);
        window.scrollTo(0, document.body.scrollHeight);
      });
    </script>
  </body>
</html>
